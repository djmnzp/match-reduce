/* This is the slowest Brainf*ck intepreter the world will ever see */

0 0  + : [[ *a ^ ?p *b ]] +        =>> [[ :a ^ add :p 1 :b ]] ;
0 0  - : [[ *a ^ ?p *b ]] -        =>> [[ :a ^ add :p -1 :b ]] ;
0 0 e> : [[ *a ^ ?p    ]] >        =>> print RIGHT_OVERFLOW ;
0 0  > : [[ *a ^ ?p *b ]] >        =>> [[ :a :p ^ :b ]] ;
0 0 e< : [[    ^ ?p *b ]] <        =>> print LEFT_OVERFLOW ;
0 0  < : [[ *a ?p ^ *b ]] <        =>> [[ :a ^ :p :b ]] ;
0 0 0[ : [[ *a ^ 0  *b ]] =[ *l =] =>> [[ :a ^ 0 :b ]] ;
0 0  [ : [[ *a ^ ?p *b ]] =[ *l =] =>> || [ :l [[ :a ^ :p :b ]] :l ] ;
0 0 0] : || *x [[ *a ^ 0  *b ]] ]  =>> [[ :a ^ 0 :b ]] ;
0 0  ] : || *x [[ *a ^ ?p *b ]] ]  =>> [[ :a ^ :p :b ]] :x ] ;
0 0  . : [[ *a ^ ?p *b ]] .        =>> [[ :a ^ print_ascii :p :p :b ]] ;

0 0 start        : main => mem-cells 15 hello_world ;

0 0 sq : sq => + + + + [ > + + + +  + < - ] > [ <  + + + + + > - ] + < + [
    > [ > + > + < < - ] + +  > >  [ < < + > > - ] > > > [ - ] + + > [ - ] +
    > > > +  [ [ - ] +  + + + + +  > > > ] < < <  [ [ < + + + + + + + + < + +  > > - ] + < . < [  > - - - -  <  - ] < ]
    < < [ > > > > > [ > > > [ - ] + + + + + + + + + < [ > - < - ] + + + + + + + + + > [ - [ < - > - ] + [ < < < ] ] < [ > + < - ] > ] < < - ] < < -
]
;

0 0 morse : morse => > > + + + + + + [ > + + + + + + + + < - ] + [ [ > . [ > ] + < < [ - > - < < < ] > [ > + < < ] > ] > + + < + + ] ;
0 0 factorial : factorial => > > > > + + > + [
    [
        > [ > > ] < [ > + > ] < < [ > - > > + < < < - ] > + [
            [ + > > [ < < + > > - ] > ] + [ - < < + < ] > - [
                - [ < + > > + < - ] + + + + + + [ > + + + + + + + + < - ] + > . [ - ] < < [
                    > > > [ [ < < + > + > - ] > > > ] < < < < [ [ > + < - ] < - < < ] > -
                ] > > > [
                    < < - [ < < + > > - ] < + + + + + + + + + < [
                        > [ - > + > ] > > > [ < < [ < + > - ] > > > + > > [ - < ] < [ > ] > + < ] < < < < < < -
                    ] > [ - ] > + > > [ < < < + > > > - ] > > >
                ] < < < + [ - [ + > > ] < < < ] > [ < < < ] >
            ] > > > [ < [ > > > ] < < < [ [ > > > + < < < - ] < < < ] > > > > > > > - [ < ] > > > [ < < ] < < [ > + > ] < ] < <
        ] + + > >
    ] < < + + + + + + + + . +
]
;

0 0 hello_world  : hello_world => + + + + + + + + [ > + + + + [ > + + > + + + > + + + > + < < < < - ] > + > + > - > > + [ < ] < - ] > > . > - - - . + + + + + + + . . + + + . > > . < - . < . + + + . - - - - - - . - - - - - - - - . > > + . > + + . ;
0 0 impeccable   : impeccable => > > > - > + [ [ [ < < + > + > - ] + + + + + + [ < < + + + + + + + + > > - ] < < - . [ - ] < ] + + + + + + + + + + . [ - ] > > > + + < [ [ - [ [ > > > ] < < < - [ + > > > ] < < < [ < < < ] + > ] < - [ + > + + + + + + + + + + > > ] > ] > > > [ [ > + < - ] > > > ] < < [ - [ < + + > - [ < + + > - [ < + + > - [ < + + > - [ < [ - ] > - [ < + + > - ] > > [ < + < ] > [ - > ] < + + < < ] ] ] ] ] < + < < ] > ] > [ > > > ] < < < ] ;

0 10 memory   : mem-cells ?n =>> [[ ^ init-mem :n ]] ;
0 1 init-mem : init-mem 0 =>> ;
0 1 init-mem : init-mem ?n =>> 0 init-mem add :n -1 ;


0 2 add : add ?x ?y =>> $add :x :y ;
0 2 print : print_ascii ?x =>> print tochar :x ;
0 2 print_l : print ?x =>> $print :x ;
0 3 tochar : tochar ?x =>> $tochar :x ;
